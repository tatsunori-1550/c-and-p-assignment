# c-and-p-assignment

#  C&amp;P株式会社 面接課題（マンガ喫茶の料金計算処理）

##  概要
PHPの `DateTimeImmutable` クラスを使用して、  
入退店時刻とコース種別から料金を自動計算するプログラムです。  

### 対応要件
- コースごとの基本料金設定
- 経過時間の計算
- コース時間を超えた場合の延長料金（10分ごと100円）
- 1分でも超過すれば延長扱い（切り上げ）
- 深夜割増（22:00〜翌5:00）15%増
- 税抜・税込の両方を算出（税率10%）

---

##  実装ファイル
`manga_cafe_fee.php`

---

##  使用技術
- PHP 8.2
- Docker (php:8.2-cli イメージ)
- DateTimeImmutable クラスを使用した安全な時間管理

---

##  クラス設計

### **MangaCafeCalculator クラス**
| メソッド名 | 概要 |
|-------------|------|
| `calculate($enter, $exit, $course)` | 料金計算のメイン処理 。経過時間や延長・割増を含めて総額を算出。 |
| `isLateNight($enter, $exit)` | 深夜時間帯(22:00〜翌5:00)を1分でも含むか判定 |

---

##  設計ポイント

| 項目 | 意図 |
|------|------|
| **クラス構造** | 今後の拡張性（他店舗・新コースなど）を見据えてクラス化。 |
| **定数（`const`）** | 税率や深夜割増率など、変更されにくい値を明示的に固定。 |
| **`DateTimeImmutable` 採用** | 参照渡しによる予期せぬ値変更を防ぎ、安全に時間計算が可能。 |
| **`static` メソッド** | 状態を持たない計算処理のため、インスタンス化不要にして可読性を向上。 |
| **`ceil()` 関数使用** | 延長料金計算で1秒でも超過したら切り上げ（要件通り）。 |
| **深夜判定ロジック** | 10分ごとに時刻を進めて効率的にチェック（パフォーマンスを考慮）。 |

---

##  料金仕様

| コース | 時間 | 料金（税抜） |
|--------|------|---------------|
| 通常 | 1時間 | 500円 |
| 3時間パック | 3時間 | 800円 |
| 5時間パック | 5時間 | 1500円 |
| 8時間パック | 8時間 | 1900円 |
| 延長 | 10分ごと | 100円 |
| 深夜割増 | 22:00〜翌5:00 | 延長料金15%増 |
| 消費税 | 一律10% | |

---

##  実行結果（テスト例）

### 入店：2025-10-05 21:00  
### 退店：2025-10-06 23:45  
### コース：3時間パック

```bash
Array
(
    [コース] => 3時間パック
    [入店] => 2025-10-05 21:00
    [退店] => 2025-10-06 23:45
    [経過時間(分)] => 1605
    [延長料金(税抜)] => 16445
    [深夜割増対象] => あり
    [合計(税込)] => 18970
)